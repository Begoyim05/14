#include <iostream>
#include <vector>
#include <string>
using namespace std;

struct Edge {
    int u, v;
};

int main() {
    int n, m;
    cin >> n >> m;
    vector<Edge> edges;
    edges.reserve(m);
    for (int i = 0; i < m; ++i) {
        int u, v;
        cin >> u >> v;
        edges.push_back({u, v});
    }

    int q;
    cin >> q;

    while (q--) {
        string type;
        cin >> type;

        if (type == "EDGES") {

            if (edges.empty()) {
                cout << "NONE\n";
            } else {
                for (auto &e : edges)
                    cout << e.u << " " << e.v << "\n";
            }
        }

        else if (type == "DEG") {
            int v;
            cin >> v;
            int degree = 0;
            for (auto &e : edges) {
                if (e.u == v || e.v == v)
                    degree++;
            }

            cout << degree << "\n";
        }

        else if (type == "ADJ") {
            int u, v;
            cin >> u >> v;
            bool found = false;
            for (auto &e : edges) {
                if ((e.u == u && e.v == v) ||
                    (e.u == v && e.v == u)) {
                    found = true;
                    break;
                }
            }
            cout << (found ? "YES\n" : "NO\n");
        }
    }

    return 0;
}
